<div id="korbplanung" class="row">
  <div class="content content-box col-md-12">
    <div oo-error-overlay></div>
    <form name="kundeForm">
      <div class="row">
        <div class="col-md-12">
          <div class="row form-group">
            <h3 translate>
              <div class="col-md-4" translate>
                Korbplanung
              </div>
              <div class="col-md-8">
                <div class="pull-right" role="group">
                  <a role="button" ng-href="#/korbplanung/id/produzentenoverview" class="btn btn-default" translate><span class="fa fa-step-forward"></span> Produzenten-Übersicht</a>
                  <oo-save-button model="kunde" form="kundeForm" entity="Korbplanung" on-save="save" on-cancel="backToList" on-created="created"><span translate>Planung</span></oo-save-button>
                  <button role="button" ng-click="planungAbschliessen()" class="btn btn-success" translate><span class="fa fa-check"></span> Planung abschliessen</button>
                </div>
              </div>
            </h3>
            </h3>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <div class="panel panel-default panel-fixed-height-100">
            <div class="panel-heading clearfix">
              <h3 class="panel-title"><span class="navbar-brand" translate>Angebot</span></h3>
            </div>
            <div class="panel-body">
              <table ng-table="tableParams" class="table table-striped" show-filter="true" template-pagination="scripts/common/ngtable/oo-ngtable-noPaginationTemplate.html">
                <tr ng-repeat="produkt in $data">
                <td><span draggable="true" ondragstart="angular.element($('#korbplanung')).scope().dragProdukt(event)" title="My tip">&#8942</span></td>
                  <td title="'Produkt'|translate" sortable="'bezeichnung'" filter="{bezeichnung: 'text'}">
                    {{produkt.bezeichnung}}
                  </td>
                  <td title="'Preis'|translate" filter="{preis: 'number'}">
                    {{produkt.preis}}
                  </td>
                  <td title="'Prod.'|translate" filter="{produzent: 'select'}" filter-data="produzentenL">
                    <span ng-repeat="produzent in produkt.produzenten">{{produzent}}&nbsp;</span>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <div class="col-md-4" ng-repeat="abotyp in abotypen"
          ondragover="angular.element($('#korbplanung')).scope().dragOver(event)"
          ondragout="angular.element($('#korbplanung')).scope().dragOut(event)"
          ondrop="angular.element($('#korbplanung')).scope().drop(event)">
          <div class="panel panel-default">
            <div class="panel-heading clearfix">
              <h3 class="panel-title">
                <span class="navbar-brand" translate>{{abotyp.name}}</span>
                <span class="pull-right">
                  <small><b>Ø {{12.31121|ooCHF:true}} </b>| {{abotyp.lieferdatum}}</small>
                  <button role="button" ng-click="produkteInClipboard()" class="btn btn-default" draggable="true"
                    ondragstart="angular.element($('#korbplanung')).scope().dragAbotyp(event)" translate><span class="fa fa-files-o"></span></button>
                  <button role="button" ng-click="removeFromPlanung(korb)" class="btn btn-default" translate><span class="fa fa-times"></span></button>
                </span>
              </h3>
            </div>
            <div class="panel-body">
              <table ng-table="tableParamsKorb" class="table table-striped table-small table-planung" template-pagination="scripts/common/ngtable/oo-ngtable-noPaginationTemplate.html">
                <tr ng-repeat="korbprodukt in $data">
                  <td><span draggable="true" ondragstart="angular.element($('#korbplanung')).scope().dragProdukt(event)">&#8942</span></td>
                  <td title="'Produkt'|translate">
                    {{korbprodukt.bezeichnung}}
                  </td>
                  <td title="'Menge'|translate">
                    <div class="input-group">
                      <input type="number" placeholder="{{'Menge'|translate}}" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/" step="1" class="form-control" name="menge" ng-model="korbprodukt.menge" required></input>
                      <div class="input-group-addon">{{korbprodukt.einheit|translate}}</div>
                    </div>
                  </td>
                  <td title="'Preis'|translate">
                    <span ng-show="korbprodukt.menge">
                      {{(korbprodukt.preisEinheit * korbprodukt.menge)| ooCHF}}
                    </span>
                    <span ng-hide="korbprodukt.menge" class="base-preis">
                      {{korbprodukt.preisEinheit}}
                    </span>
                  </td>
                  <td title="'Prod.'|translate">
                    <oo-dropdown dropdown-id="produzent" display-style="uib-dropdown" values="produzentenL" property="title" selected-prop="id" selected="korbprodukt.produzent" required></oo-dropdown>
                  </td>
                  <td>
                    <button class="btn btn-default btn-sm"><span class="fa fa-times"></span></button>
                  </td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td translate>Total</td>
                  <td>{{getTotal(korbEntries)| ooCHF}}</td>
                  <td><span class="liefersumme" ng-class="{'red':getDiff(abotyp.zielpreis, korbEntries) < 0}">&#916; {{getDiff(abotyp.zielpreis, korbEntries)| ooCHF}}</span></td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
